<!DOCTYPE html>
<html>

<head>
<title>年级组信息列表</title>
<link rel="stylesheet" href="/plugin/layui/css/layui.css" />
<script src="/plugin/jquery/jquery.js"></script>
<script src="/plugin/jquery/jquery.serializejson.js"></script>
<script src="/plugin/jsrender/jsrender.js"></script>
</head>

<body>
  <div class="layui-container" style="width:100%;">
    <table class="layui-table">
      <thead>
        <tr>
          <th>年级组ID</th>
          <th>入学年份</th>
          <th>学期</th>
          <th>初/高中</th>
          <th>年级</th>
          <th>起始日期</th>
          <th>操作</th>
        </tr>
      </thead>
      <tbody id="groupList">
      </tbody>
    </table>
    <div class="layui-input-inline">
      <button class="layui-btn" onclick="goBack()">返回</button>
      <button class="layui-btn" onclick="goCreate()">新增</button>
    </div>
  </div>
  <script id="tmpl-groupList" type="text/x-jsrender">
    <tr>
      <td>{{:groupId}}</td>
      <td>{{:year}}</td>
      <td>{{:semester}}</td>
      <td>{{:level}}</td>
      <td>{{:exam}}</td>
      <td>{{:startDate}}</td>
      <td>
        <button class="layui-btn layui-btn-sm" onclick="goModify('{{:groupId}}')">修改</button>
        <button class="layui-btn layui-btn-sm" onclick="remove('{{:groupId}}')">删除</button>
        <button class="layui-btn layui-btn-sm" id="chcourse" onclick="chcourse('{{:groupId}}')">选择课程</button>
        <button class="layui-btn layui-btn-sm" id="chteacher" onclick="chteacher('{{:groupId}}')">选择教师</button>
      </td>
    </tr>
  </script>
  <script>
    $(document).ready(function() {
      list();
    })
  
    function goCreate() {
      layui.use('layer', function() {
        var layer = layui.layer;
        layer.open({
          type : 2,
          id : 'create',
          title : '新增年级组信息',
          content : '/html/schedule/group/create.html',
          area : [ '700px', '500px' ],
          shade : 0.5,
          closeBtn : false
        });
      });
    }
  
    function goModify(groupId) {
      sessionStorage.setItem('currentGroupId', groupId);
      layui.use('layer', function() {
        var layer = layui.layer;
        layer.open({
          type : 2,
          id : 'modify',
          title : '修改年级组信息',
          content : '/html/schedule/group/modify.html',
          area : [ '700px', '500px' ],
          shade : 0.5,
          closeBtn : false,
        });
      });
    }
    
    function chcourse(groupId) {
      sessionStorage.setItem('currentGroupId', groupId);
      $(document).ready(function(){
          $("#chcourse").click(function(){
         $(this).css("background-color","yellow");
     
        });
      });
          
      layui.use('layer', function() {
        var layer = layui.layer;
        layer.open({
          type : 2,
          id : 'choosecourse',
          title : '选择年级组课程信息',
          content : '/html/schedule/group/choose.html',
          area : [ '700px', '500px' ],
          shade : 0.5,
          closeBtn : false,
        });
      });
    }
    
     function chteacher(groupId) {
      sessionStorage.setItem('currentGroupId', groupId);
      $(document).ready(function(){
          $("#chteacher").click(function(){
         $(this).css("background-color","blue");
     
        });
      });
          
      layui.use('layer', function() {
        var layer = layui.layer;
        layer.open({
          type : 2,
          id : 'chooseteacher',
          title : '选择年级组教师信息',
          content : '/html/schedule/group/chteacher.html',
          area : [ '700px', '500px' ],
          shade : 0.5,
          closeBtn : false,
        });
      });
    }
    
    function remove(groupId) {
      layer.confirm('确认要删除吗？',
        {title : '删除年级组信息'},
        function(index) {
          $.ajax({
            async : false,
            type : 'DELETE',
            url : '/group/delete/' + groupId,
            success : function() {
              layer.close(index);
              list();
            }
          });
        });
    }

    
    
    function list() {
      $.ajax({
        async : false,
        type : 'GET',
        url : '/group/list',
        success : function(groupList) {
          $('#groupList').html($.templates('#tmpl-groupList').render(groupList));
        }
      });
    }
  
    function goBack() {
      jump('html/schedule/group/list.html');
    }
  </script>
</body>

</html>
